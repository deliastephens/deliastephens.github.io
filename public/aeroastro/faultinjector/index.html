<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Fault Injector | delia stephens</title>
<meta name="keywords" content="" />
<meta name="description" content="Development of a robust SITL UAV testing environment.">
<meta name="author" content="Delia Stephens">
<link rel="canonical" href="/aeroastro/faultinjector/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.db7668896a7cc4f013323b524ea5ca4b93add296f49245667403626124f7fbd0.css" integrity="sha256-23ZoiWp8xPATMjtSTqXKS5Ot0pb0kkVmdANiYST3&#43;9A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="mask-icon" href="/images/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="" accesskey="h" title="delia stephens (Alt + H)">delia stephens</a>
            <span class="logo-switches">
            </span>
        </div>
        <ul id="menu">
            
            
            
            <li>
                <a href="/aeroastro/" title="aeroastro">
                    <span>aeroastro</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="">home</a>&nbsp;»&nbsp;<a href="/aeroastro/">aero/astro</a></div>
    <h1 class="post-title">
      Fault Injector
    </h1>
    <div class="post-description">
      Development of a robust SITL UAV testing environment.
    </div>
    <div class="post-meta">3 min&nbsp;·&nbsp;Delia Stephens</div>
  </header> 
  <div class="post-content">
  <h2 id="project-overview">Project Overview</h2>
<p>Testing UAVs in the field can be costly: not only must you charge batteries, go through checklists, prepare the drone, transport people and materials to the testing site, and return everything to its place, there is the chance that the changes you have made will fail. Software-in-the-loop (<a href="http://ardupilot.org/dev/docs/sitl-simulator-software-in-the-loop.html">SITL</a>) simulation eliminates the need for physical tests but maintains the integrity of the testing environment by linking a flight dynamics model such as <a href="http://jsbsim.sourceforge.net/">JSBSim</a> to the autopilot, enabling rapid development and testing of UAV software.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>However, current SITL solutions do not allow for the rapid testing of multiple missions in succession. Additionally, simulations are typically run in the ideal environment, assuming perfect connections to the UAV and all its equipment.
Developing further on the deprecated work by <a href="http://jaysonboubin.com/">Jayson Boubin</a>, I modified the <a href="https://github.com/boubinjg/FaultInjector">UAV FaultInjector</a> to load, modify, and reset MissionPlanner Waypoint files, run multiple missions, and perform robust UAV testing in concert with open-source flight dynamics simulators.</p>
<p><a href="https://github.com/deliastephens/FaultInjector">Here</a> is my code for the FaultInjector, <a href="https://gist.github.com/deliastephens/6eb3fb3111f5d854bb240c7649847c1f">here</a> is a more detailed description of how to get SITL running, and <a href="https://gist.github.com/deliastephens/fb2cfeb348b4ac89e1acd20d751836a9">here</a> are the personal notes I kept while developing this project. Enjoy!</p>
<h2 id="setting-up-sitl">Setting up SITL</h2>
<p>My first task was connecting the SITL physics simulator to a flight simulator for effective mission visualization. Because much of the documentation was outdated, I have written my own guide, available <a href="https://gist.github.com/deliastephens/6eb3fb3111f5d854bb240c7649847c1f">here</a>.</p>
<p>I eventually ended up with a FlightGear visualization connected to my instance of JSBSim. It received missions through MAVProxy and MissionPlanner. With this implementation, you can create missions, run them in real-life locations, and see if the autopilot fails given certain conditions.</p>
<figure><img src="/images/thankyou.png"/>
</figure>





	




































  	
	

	
	
	
		<script src="/shortcode-gallery/lazy/jquery.lazy.min.js"></script>
	

	<script src="/shortcode-gallery/swipebox/js/jquery.swipebox.min.js"></script>
	<link rel="stylesheet" href="/shortcode-gallery/swipebox/css/swipebox.min.css">

	<script src="/shortcode-gallery/justified_gallery/jquery.justifiedGallery.min.js"></script>
	<link rel="stylesheet" href="/shortcode-gallery/justified_gallery/justifiedGallery.min.css"/>


<style>
	

	
</style>





<div id="gallery-12ebcef3b0fc1457936a73f273c97c0c-1-wrapper" class="gallery-wrapper">
<div id="gallery-12ebcef3b0fc1457936a73f273c97c0c-1" class="justified-gallery">
	
</div>
</div>

<script>
	if (!jQuery) {
		alert("jquery is not loaded");
	}

	$( document ).ready(() => {
		const gallery = $("#gallery-12ebcef3b0fc1457936a73f273c97c0c-1");
		

		
		let swipeboxInstance = null;

		
		
		gallery.on('jg.complete', () => {
			
				
				
				$(() => {
					$('.lazy').Lazy({
						visibleOnly: true,
						afterLoad: element => element.css({filter: "none", transition: "filter 1.0s ease-in-out"})
					});
				});
			

			swipeboxInstance = $('.galleryImg').swipebox(
				jQuery.extend({},
					{  }
				)
			);
		});

		
		gallery.justifiedGallery({
			rowHeight : "150",
			margins : "5",
			border : 0,
			randomize :  false ,
			waitThumbnailsLoad : false,
			lastRow : "justify",
			captions : false,
			
			
		});

		
		
	});
</script>

<h2 id="fault-injection">Fault Injection</h2>
<p>Once I had SITL running on my computer, I decided to take the existing FaultInjector script and modify it to be able to:</p>
<ul>
<li>Load missions from a .txt file</li>
<li>Run a SITL simulation</li>
<li>Reset drone position after a completed mission</li>
<li>Run multiple missions in succession</li>
<li>Interface with existing Ground Control systems</li>
</ul>
<p><a href="https://github.com/deliastephens/FaultInjector"><img loading="lazy" src="https://github.com/deliastephens/FaultInjector/blob/master/res/FaultInjector.PNG?raw=true" alt="Final Product"  />
</a></p>
<p>A build log is available <a href="https://gist.github.com/deliastephens/fb2cfeb348b4ac89e1acd20d751836a9">here</a>, but I was ultimately able to update the FaultInjector to reflect changes in Python and ArduPilot development, add the functionality to load missions, start and stop SITL instances, and run multiple missions in succession. With this tool, rapid development and testing of autopilots is made simple and practical.</p>
<p>For a more detailed user guide, please go to <a href="https://github.com/deliastephens/FaultInjector">the FaultInjector Github page</a>.</p>

  </div>

  <footer class="post-footer">
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span> modified with ♥ from <a href="https://github.com/charlola/hugo-theme-charlolamode">charlola</a>
      
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
